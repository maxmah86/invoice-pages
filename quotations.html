<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Quotations</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="/js/config.js"></script>
<script src="/js/company-settings.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  background:#f4f6f8;
  margin:0;
  padding:12px;
}
h2 { margin:0 0 12px 0; }

.box {
  background:#fff;
  padding:14px;
  border-radius:8px;
}

table {
  width:100%;
  border-collapse:collapse;
  font-size:14px;
}
th, td {
  border:1px solid #ddd;
  padding:8px;
}
th {
  background:#f0f0f0;
}
.right { text-align:right; }

a {
  color:#007bff;
  text-decoration:none;
}
</style>
</head>

<body>

<div class="box">
  <h2>Quotations</h2>

  <table>
    <thead>
      <tr>
        <th>No</th>
        <th>Customer</th>
        <th>Project</th>
        <th>Status</th>
        <th class="right">Amount (RM)</th>
        <th>Date</th>
      </tr>
    </thead>
    <tbody id="list"></tbody>
  </table>
</div>

<script>
fetch(CONFIG.API_BASE_URL + '/quotations')
  .then(r => r.json())
  .then(json => {
    if (!json.success) {
      alert(json.error || 'Failed to load');
      return;
    }

    const tbody = document.getElementById('list');
    tbody.innerHTML = '';

    json.data.list.forEach(q => {
      const tr = document.createElement('tr');

      tr.innerHTML = `
        <td>
          <a href="/quotation-view.html?id=${q.id}">
            ${q.quotation_no}
          </a>
        </td>
        <td>${q.customer || ''}</td>
        <td>${q.project_title || ''}</td>
        <td>${q.status || 'OPEN'}</td>
        <td class="right">
          ${CONFIG.CURRENCY} ${(q.grand_total || 0).toFixed(2)}
        </td>
        <td>${q.created_at?.slice(0,10) || ''}</td>
      `;

      tbody.appendChild(tr);
    });
  });
</script>

</body>
</html>